<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
<teiHeader>
<fileDesc xml:id="_1"/>
<encodingDesc>
<appInfo>
<application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T15:46+0000">
<ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
</application>
</appInfo>
</encodingDesc>
</teiHeader>
<text xml:lang="en">
<p>Estimation of the effective reproductive number, R t , is important for detecting changes in disease transmission over time. During the COVID-19 pandemic, policymakers and public health officials are using R t to assess the effectiveness of interventions and to inform policy. However, estimation of R t from available data presents several challenges, with critical implications for the interpretation of the course of the pandemic. The purpose of this document is to summarize these challenges, illustrate them with examples from synthetic data, and, where possible, make recommendations. For near real-time estimation of R t , we recommend the approach of Cori et al. ( 2013), which uses data from before time t and empirical estimates of the distribution of time between infections. Methods that require data from after time t, such as Wallinga and Teunis (2004), are conceptually and methodologically less suited for near real-time estimation, but may be appropriate for retrospective analyses of how individuals infected at different time points contributed to spread. We advise against using methods derived from Bettencourt and Ribeiro (2008), as the resulting R t estimates may be biased if the underlying structural assumptions are not met. Two key challenges common to all approaches are accurate specification of the generation interval and reconstruction of the time series of new infections from observations occurring long after the moment of August 27, 2020 1/25 NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice. transmission. Naive approaches for dealing with observation delays, such as subtracting delays sampled from a distribution, can introduce bias. We provide suggestions for how to mitigate this and other technical challenges and highlight open problems in R t estimation.</p>
<p>The effective reproductive number, denoted R e or R t , is the expected number of new infections caused by an infectious individual in a population where some individuals may no longer be susceptible. Estimates of R t are used to assess how changes in policy, population immunity, and other factors have affected transmission at specific points in time [1][2][3][4][5]. The effective reproductive number can also be used to monitor near real-time changes in transmission [6-10]. For both purposes, estimates need to be accurate and correctly represent uncertainty, and for near real-time monitoring, they also need to be timely.</p>
<p>We consider two potential forms of bias in R t estimates, systematic over-or underestimation and temporal inaccuracy. Misspecification of the generation interval is a large potential source of over-or underestimation, and we find that R t estimates are most prone to this kind of bias when the true value is substantially greater or less than one. This situation might arise at the beginning of the COVID-19 pandemic (when R t is relatively high) or after particularly effective interventions (when it might be low).</p>
<p>Over or underestimation would have particularly strong practical consequences near the control threshold of R t = 1, but the biases we observe are smallest in absolute terms in this range.</p>
<p>Another challenge is that depending on the methods used, R t estimates may be leading or lagging indicators of the true value [4,11], even measuring transmission events that occurred days or weeks ago if the data are not properly adjusted. Temporal inaccuracy in R t estimation is particularly concerning when trying to infer how changes in behavior have affected transmission [1][2][3][4][5]. Temporal inaccuracy, for instance in the estimation of the date on which R t falls below one, is a focus of this Perspective. We find that it has several possible causes and can be difficult to avoid. This perspective focuses on the three main empirical methods to estimate R t [12][13][14][15]. As an alternative to the methods reviewed here, it is possible to infer changes in transmission using a dynamical compartment model (e.g. [3,[16][17][18]). The accuracy and timeliness of R t estimates obtained in this way should be assessed on a case-by-case basis, given sensitivity to model structure and data availability.</p>
<p>We use synthetic data to compare the accuracy of three common empirical methods to estimate R t , first under ideal conditions, in the absence of parametric uncertainty and with all infections observed at the moment they occur. This idealized analysis is intended to illustrate the inputs needed to estimate R t accurately, to highlight the intrinsic differences between the methods, and to examine specific causes of bias and August 27, 2020 2/25</p>
<p>temporal inaccuracy one by one. However, we emphasize that our idealized analyses overestimate the potential accuracy of R t estimates obtained from real-world data, even if best practice are followed. The results show that the method of Cori et al. [14] is best for near real-time estimation of R t . For retrospective analysis, the methods of Cori et al.</p>
<p>or of Wallinga and Teunis may be appropriate, depending on the aims.</p>
<p>Later we add realism and address practical considerations for working with imperfect data. These analyses emphasize potential errors introduced by uncertainty in the intrinsic generation interval and imperfect case observation, and also the need to adjust for delays in case observation, right truncation, and the need to choose an appropriate smoothing window given the sample size. Finally, we emphasize that most off-the-shelf tools leave it up to the user to account for these five sources of uncertainty when calculating confidence intervals. Failure to propagate uncertainty in R t estimates can lead to over-interpretation of the results and could falsely imply that confidence or credible intervals have crossed the critical threshold.</p>
<p>We used synthetic data to compare three common R t estimation methods. Synthetic data were generated from a deterministic or stochastic SEIR model in which the transmission rate drops and spikes abruptly, representing the adoption and lifting of public health interventions. Results were similar whether data were generated using a deterministic or stochastic model. For simplicity, we show deterministic outputs throughout the document, except in the section on smoothing windows, where stochasticity is a conceptual focus.</p>
<p>In our model, all infections are locally transmitted, but all three of the methods we test can incorporate cases arising from importations or zoonotic spillover [12,13,15].</p>
<p>Estimates of R t are likely to be inaccurate if a large proportion of cases involve transmission outside the population. This situation could arise when transmission is low (e.g., at the beginning or end of an epidemic) or when R t is defined for a population that is connected to others via migration.</p>
<p>A synthetic time series of new infections (observed at the S → E transition) was input into the R t estimation methods of Wallinga and Teunis, Cori et al., and Bettencourt and Ribeiro [12][13][14]. Following the published methods, we also tested the Wallinga and Teunis estimator using a synthetic time series of symptom onset events, extracted daily from the E → I transition. In the synthetic data, the generation interval followed a gamma distribution with shape 2 and rate 1 4 , which is the sum of exponentially distributed residence times in compartments E and I, each with mean of 4 days [19]. The methods of Cori et al. and of Wallinga and Teunis can accommodate any positive, discrete generation interval distribution [12,14,20]. We chose a discretized, gamma-distributed generation interval for our simulations, which is similar in shape to the interval of COVID-19 [21,22]. However, the method of Bettencourt and Ribeiro implicitly assumes the generation interval follows an exponential distribution, as in an SIR model with no latent period [13,19], and thus could not match the assumptions of the synthetic data.</p>
<p>In the synthetic data, R 0 was set to 2.0 initially, then to 0.8 and 1.15, to simulate the adoption and later the partial lifting of public health interventions. To mimic estimation in real-time, we truncated the time series at t = 150, before the end of the epidemic. Estimates from the methods of Wallinga and Teunis and Cori et al. were obtained using the
<rs xml:id="12894682" type="software" subtype="environment">R</rs> package
<rs xml:id="12894683" type="software" subtype="component" corresp="12894682">EpiEstim</rs> <rs xml:id="12953672" type="bibr">[20]</rs>. Estimates based on the method of Bettencourt and Ribeiro were obtained by translating <rs xml:id="12894685" type="software" subtype="implicit">code</rs> from [<rs xml:id="12894686" type="bibr">6</rs>,<rs xml:id="12894687" type="bibr">23</rs>] to the <rs xml:id="12894688" type="language">Stan</rs> language <rs xml:id="12953673" type="bibr">[24]</rs>. We initially assumed all infections were observed. Unless otherwise noted, the smoothing window was set to 1 day (effectively, estimates were not smoothed). To August 27, 2020 3/25 mimic the timescale of observations, we used daily time steps when generating synthetic data and performing analyses.
</p>
<p>The effective reproductive number at time t can be defined in two ways: as the instantaneous reproductive number or as the case reproductive number [14,25]. The instantaneous reproductive number measures transmission at a specific point in time, whereas the case reproductive number measures transmission by a specific cohort of individuals (Fig. 1). More formally, the instantaneous reproductive number is defined as the expected number of secondary infections occurring at time t, divided by the number of infected individuals, each scaled by their relative infectiousness at time t (an individual's relative infectiousness is based on the generation interval, and time since infection) [14,25]. The instantaneous reproductive number can be calculated exactly for a compartment model (SIR or SEIR) as follows, where β(t) is the time-varying transmission rate, S(t) the fraction of the population that is susceptible, and D the mean duration of infectiousness:</p>
<p>The methods of Cori et al. [14,15] and methods adapted from Bettencourt and Ribeiro [6, 13,23] estimate the instantaneous reproductive number from observations.</p>
<p>We tested their accuracy under idealized conditions, assuming perfect knowledge of the generation interval and delay distributions used to generate the synthetic data (Fig. 2 and S2 Fig).</p>
<p>The method of Cori et al. estimates R t as</p>
<p>where I t is the number of infections incident on day t and w s is generation interval, or the probability that s days separate the moment of infection in an index case and a daughter case [14]. Conceptually, this estimator describes the number of new infections incident on day t relative to the number (I t-s ) and current infectiousness (w s ) of individuals who became infected s days in the past, and who many now be shedding virus.</p>
<p>The only parametric assumption required by this method is the form of the generation interval. The standard assumption is that w s follows a discretized gamma distribution [14,20], but the estimator accepts any parametric or empirical discrete distribution with support on positive values (the same is true of the Wallinga and</p>
<p>Teunis method [12]). Thus, when testing the method on COVID-19-like epidemic processes, we could specify the gamma-distributed generation interval of the synthetic data perfectly. When tested under idealized conditions, we found that the method of The first definition applies when estimating the case reproductive number using inferred times of infection, and the second applies when using data on times of symptom onset.</p>
<p>Cori et al. accurately estimated R t , even tracking abrupt changes (Fig. 2). This is the method we recommend for estimation of the instantaneous reproductive number.</p>
<p>Bettencourt and Ribeiro [13] derive an approximate relationship between the R t and the exponential growth rate of the epidemic, where g is the mean generation time: August 27, 2020 5/25</p>
<p>Under the assumption that R t evolves through time as a Gaussian process, equation 3 facilitates efficient Bayesian R t estimation [23]. The key disadvantage of this method is that equation 3 is derived from an SIR model, and therefore implicitly assumes the generation interval follows an exponential distribution [19], whereas empirically, generation intervals can be heavy or light tailed, including for COVID-19 [21,22,28].</p>
<p>Because equation 3 underestimates variability in the gamma-distributed generation interval of our SEIR-type synthetic data, we find that this method produces biased R t estimates, especially when R t is substantially higher than one (Fig. 2A). These biases are consistent with established theory, in which the coefficient of variation of the generation interval modulates the relationship between exponential growth rate and the reproductive number of an epidemic [19].</p>
<p>In its current form, we do not recommend using the method of Bettencourt and Ribeiro given that unrealistic structural assumptions lead to bias. However, a generalized version capable of accommodating more realistic generation intervals, which implicitly involves different assumptions about the underlying epidemic process [19,29], could provide several advantages. When implemented as a Gaussian process [23], we found that the Bettencourt and Ribeiro method was computationally efficient. Also, because it penalizes large jumps in R t across consecutive time steps, it returns smoother estimates than the method of Cori et al., which is advantageous if unmodeled reporting effects, rather than bursts in transmission, are the dominant cause of variability in daily observations. Finally, the case or cohort reproductive number is the expected number of secondary infections that an individual who becomes infected at time t will eventually cause as they progress through their infection [14,19,25] (Fig. 1B,C). The case reproductive number R case t can be calculated exactly at time t within the synthetic data as the convolution of the generation interval distribution w(•) and the instantaneous reproductive number, R inst t , described in Equation 1 [19],</p>
<p>The method of Wallinga and Teunis [12] estimates the case reproductive number from observations. The first step is to estimate the likelihood that case j (infected at time t j ) infected case i, relative to the likelihood that any other case in the data infected case i:</p>
<p>Then, the individual reproductive number of case j is defined as</p>
<p>The case reproductive number at time t is defined as the expected value of R j for all individuals infected at time t. Like the method of Cori et al., the only parametric assumption required by the method of Wallinga and Teunis is the discrete distribution of the generation interval. An assumption common to the three tested methods is that all infections are observed. Below we discuss the consequences of partial observation, including that confidence or credible intervals around R t estimates do not account for uncertainty from partial observation.</p>
<p>Practically speaking, there are several important differences between the case reproductive number (estimated by Wallinga and Teunis) and the instantaneous August 27, 2020 6/25 Thus, the method produces R t estimates that lead the instantaneous effective reproductive number and becomes unreliable for real-time estimation at the end of the observed time series without adjustment for right truncation [4,30]. In (A,B) the colored line shows the posterior mean and the shaded region the 95% credible interval. In (C) the colored line shows the maximum likelihood estimate and the shaded region the 95% confidence interval.</p>
<p>reproductive number (estimated by Cori et al. or Bettencourt and Ribeiro). First, estimators of the instantaneous reproductive number were partly developed for near real-time estimation and only use data from before time t (Fig. 1A). Under ideal conditions without observation delays and a window size of one day, neither method is affected by the termination of the synthetic time series at t = 150 (Figs. 2 A&amp;B). These methods are similarly robust if the time series ends while R t is rapidly falling (S2 FigA) or rising (S2 FigB). (Below we discuss more realistic conditions, e.g., in which data at the end of a right-truncated time series are incomplete due to observation delays.)</p>
<p>Unlike the instantaneous reproductive number, the case reproductive number is inherently forward-looking (Fig. 1B,C): near the end of a right-truncated time series, it relies on data that have not yet been observed. Extensions of the Wallinga and Teunis method can be used to adjust for these missing data and to obtain accurate R t estimates to the end of a truncated time series [4,30]. But as shown in Fig. 2C, without these adjustments the method will always underestimate R t at the end of the time series, even in the absence of reporting delays. Mathematically, this underestimation occurs because calculating the case reproductive number involves a weighted sum across transmission events observed after time t. number uses data from time points before t (Fig. 1). Shifting the case reproductive number back in time by the mean generation interval usually provides a good approximation of the instantaneous reproductive number [2], because the case reproductive number is essentially a convolution of the instantaneous reproductive number and the generation interval (Equation 4) [19]. The case reproductive number generally changes more smoothly than the instantaneous reproductive number [25] (Fig. 2B,C), but if a smoothing window is used, the estimates become more similar in shape and smoothness. Overall, for real-time analyses aiming to quantify the reproductive number at a particular moment in time or to infer the impact of changes in policy, behavior, or other extrinsic factors on transmission, the instantaneous reproductive number will provide more temporally accurate estimates and is most appropriate. The case reproductive number of Wallinga and Teunis considers the reproductive number of specific individuals, and therefore is more appropriate for analyses aiming to incorporate individual-level covariates such as age [27] or transmission cluster membership [12] when estimating R t .</p>
<p>• The Cori method most accurately estimates the instantaneous reproductive number in real-time. It uses only past data and minimal parametric assumptions.</p>
<p>• The method of Wallinga and Teunis estimates a slightly different quantity, the case or cohort reproductive number. The case reproductive number is conceptually less appropriate for real-time estimation but may be useful in retrospective analyses, especially those involving individual-level covariates.</p>
<p>• Methods adapted from Bettencourt and Ribeiro [6, 13] can lead to biased R t estimates if the underlying structural assumptions are not met.</p>
<p>When estimating R t from observed data, misspecification of the generation interval is a large potential source of bias. Regardless of the method used, R t estimates are not only sensitive to the mean generation time but also to the variance and form of the generation interval distribution [19].</p>
<p>The renewal equation is a cornerstone of demographic theory and forms the mathematical backbone of the R t estimators described above [19]. Within the renewal equation, the generation interval mechanistically links the reproductive number R to observables such as the epidemic growth rate r or the number of new infections per day [19]. Wallinga and Lipsitch [19] describe how the exponential growth rate of the terms of I(t), the number of infections incident at time t; S(t), the susceptible fraction; and w(•), the generation interval distribution [29,31,32]. Note that R 0 S(t) = R t .</p>
<p>The difficulty is that the "intrinsic" generation interval of the renewal equation, which is the interval needed for accurate R t estimation, is conceptually and quantitatively different from the generation intervals observed in practice [31][32][33]. In the renewal equation, the generation interval describes the time distribution of all infectious contact events, whether or not the contacted individual is susceptible. (Note that a different factor in the equation, S(t), scales the probability of contacting a susceptible individual and causing a new infection.) The demographic analogy is that w(•) describes changes over time in the fecundity (infectiousness) of an index case, while S(t) determines whether offspring of that index case are viable. In practice, we only observe generation intervals between viable pairs. Thus, unlike the intrinsic generation interval, observed intervals are sensitive to changes in the rate of susceptible depletion and can be biased estimators of the intrinsic interval, and of R t [31][32][33]. A related challenge is that interventions such as contact tracing and self-isolation can limit transmission late in the course of infectiousness, shortening observed generation and serial intervals [32,34,35]. Methods for accurate estimation of the generation interval from contact tracing data involve adjusting for right truncation, and accounting for population susceptibility at the times transmission pairs are observed [32,33].</p>
<p>The serial interval, defined as the time between symptom onset in an infector-infectee pair, is more easily observed than the generation interval and often used in its place.</p>
<p>Although the serial and generation interval are often conflated, failure to understand the differences between these related quantities can bias R t estimates [21,32]. The serial interval and the generation interval have the same mean, but usually different variance [36,37], and the serial interval can be negative (e.g., for COVID-19 [38][39][40]), whereas the generation interval cannot [21,32]. The intrinsic generation interval can be estimated from contact tracing data (i.e., estimates of the serial interval) [32,33]. Fig. 3A illustrates the consequences of misspecifying the mean generation interval in the method of Cori et al. If the mean generation interval is set too high, R t values will typically be further from 1 than the true value-too high when R t &gt; 1 and too low when R t &lt; 1. If the mean is set too low, R t values will typically be closer to 1 than the true value. These biases are relatively small when R t is near the critical threshold of one but increase as R t takes substantially higher or lower values (Fig. 3). Therefore, biases from misspecification of the generation interval may be greatest early in an epidemic, when the sensitivity of high R t values to bias may be compounded by limited data and highly uncertain generation interval estimates.</p>
<p>The consequences of misspecifying the form and variance of the generation interval distribution are illustrated in Fig. 2A and Fig. 3B. As explained above, biases in the Bettencourt and Ribeiro estimator arise entirely from misspecification of the form of the generation interval, even if the mean is correctly specified. Similarly, the accuracy of the Cori et al. and Wallinga and Teunis estimators in Fig. 2 B,C are contingent on perfect specification of the generation interval; in practice, if the mean, variance or form of a pathogen's true generation interval is uncertain, R t estimates obtained using these methods can be biased.</p>
<p>
<rs xml:id="12894690" type="software">EpiEstim</rs> <rs xml:id="12953674" type="bibr">[20]</rs> allows users to account for uncertainty in the mean and standard deviation of the generation interval by resampling over a range of plausible values [14,20]. Similarly, Bayesian methods such as <rs xml:id="12894692" type="software">EpiNow2</rs> <rs xml:id="12953675" type="bibr">[41]</rs> and the <rs xml:id="12894694" type="software">rt.live</rs> adaptation <rs xml:id="12953676" type="bibr">[6]</rs> of the Bettencourt and Ribeiro method allow users to specify the prior variance of the mean and standard deviation. Uncertainty around an incorrect value can August 27, 2020 9/25 widen the resulting 95% interval but will not shift the assumed central value toward the truth, and will not correct bias in the central R t estimates.
</p>
<p>Joint estimation of both R t and the serial interval is possible, depending on data quality and magnitude of R t [12,42,43], and the
<rs xml:id="12894696" type="software">EpiEstim</rs> [<rs xml:id="12894697" type="bibr">15</rs>,<rs xml:id="12894698" type="bibr">20</rs>] package provides an off-the-shelf option for joint estimation. However, these off-the-shelf methods should be used with caution, as they estimate the observed serial interval, not the intrinsic generation interval, and do not account for changes over time in behavior or susceptibility.
</p>
<p>• The intrinsic generation interval is required to correctly define the relationship between R t and incident infections.</p>
<p>• The intrinsic generation interval is rarely observable, and care must be taken to estimate it from proxies such as the serial interval.</p>
<p>Estimating R t requires data on the daily number of new infections (i.e., transmission events). Due to lags in the development of detectable viral loads, symptom onset, seeking care, and reporting, these numbers are not readily available. All observations reflect transmission events from some time in the past. In other words, if d is the delay from infection to observation, then observations at time t inform R t-d , not R t (Fig. 4).</p>
<p>Obtaining temporally accurate R t estimates thus requires assumptions about lags from infection to observation. If the distribution of delays can be estimated, then R t can be estimated in two steps: first by inferring the incidence time series from observations and then by inputting the inferred time series into an R t estimation method. Alternatively, the unobserved time series could be inferred simultaneously with R t or treated as a latent state. Such methods are now under development and available in a development version of the
<rs xml:id="12894699" type="software" subtype="environment">R</rs> package
<rs xml:id="12894700" type="software" subtype="component" corresp="12894699">EpiNow2</rs> [<rs xml:id="12894701" type="bibr">41</rs>,<rs xml:id="12894702" type="bibr">44</rs>].
</p>
<p>Two simple but mathematically incorrect methods for inference of unobserved times of infection have been applied to COVID-19: convolution and temporal shifts. The August 27, 2020 10/25 errors introduced by these methods may be tolerable if delays to observation are relatively short and not highly variable, and if R t is not rapidly changing. But when dealing with longer or more variable observation delays, or when aiming to infer the timing of changes in R t accurately, these methods may not be sufficient.</p>
<p>One method infers each individual's time of infection by subtracting a sample from the delay distribution from each observation time. This is mathematically equivalent to convolving the observation time series with the reversed (backward) delay distribution, but convolution does not accurately infer the underlying time series of infections from observations [45][46][47]. The forward delay distribution has the effect of spreading out infections incident on a particular day across many days of observation. This blurring into the future is biologically realistic and reflects individual variation in disease progression and care seeking. To recover the original time series of infections from observations requires deblurring. Instead, as illustrated in (S1 Fig), backward convolution unrealistically spreads them out further. An unintended consequence of added blurring from backward convolution is that it can help smooth over weekend effects and other observation noise. But a crucial pitfall is that this blurring also smooths over true variation in R t : peaks, valleys, and changes in slope of the latent time series of infection events. Convolution and other approaches that blur or oversmooth can therefore prevent or delay detection of changes in R t and can impede accurate inference of the timing of these changes (Fig. 5C).</p>
<p>The second simple-but-incorrect method to adjust for lags is to shift either the raw inputs (the observed time series) or outputs of R t estimation on the time axis. R t estimates obtained by applying the methods of Cori et al. or Bettencourt and Ribeiro to unadjusted data will lag the true instantaneous R t by roughly the mean delay from infection to observation. Because the case reproductive number leads the instantaneous reproductive number by roughly one generation interval, the unadjusted estimates obtained from the Wallinga and Teunis method will lag the true instantaneous reproductive number by roughly the mean delay to observation minus the mean generation interval. Unlike backward convolution, temporal shifting does not further blur the observed time series. Thus, if the mean delay is known accurately, this method is preferable to subtracting samples from the delay distribution (Fig. 5 A,B). However, shifting the input time series does not undo the blurring effect of the original delay, which, like backward convolution can impede accurate inference of changes in R t .</p>
<p>Shifting inputs or R t estimates by a fixed amount also fails to account for realistic uncertainty in the true mean delay, which will not be known exactly and might change over time. development. Given a known delay distribution, one potential solution is to infer the unlagged signal using maximum-likelihood deconvolution. This method was applied to AIDS cases, which feature long delays from infection to observation [47], and in the reconstruction of incidence from mortality times series for the 2009 H1N1 pandemic [45]. It is now being applied to
COVID-19 [8,48]. Fig. 5 shows an example of deconvolution applied following the methods in [45]. The method of [47] is implemented in the <rs xml:id="12894703" type="software" subtype="component" corresp="12894704">backprojNP</rs> function within the
<rs xml:id="12894704" type="software" subtype="component" corresp="12894705">surveillance</rs> <rs xml:id="12894705" type="software" subtype="environment">R</rs> package [<rs xml:id="12894706" type="bibr">49</rs>,<rs xml:id="12894707" type="bibr">50</rs>]. In principle, deconvolution can more accurately estimate the latent time series than temporal shifting or backward convolution, but the method is sensitive to misspecification of the mean, variance or form of the delay distribution, and the stringency of the stopping condition of the deconvolution algorithm. It can also be difficult to quantify uncertainty in the deconvolved time series [41] and to implement deconvolution while adjusting for right truncation.
</p>
<p>A potential alternative to deconvolution is R t estimation models that include forward delays to observation in the inference process or that treat the time series of infections as latent states. Such methods are in development within the
<rs xml:id="12894708" type="software" subtype="environment">R</rs> package
<rs xml:id="12894709" type="software" subtype="component" corresp="12894708">EpiNow2</rs> <rs xml:id="12953677" type="bibr">[41]</rs>. An additional advantage of inferring the time series of infections jointly with R t is seamless integration of various sources of uncertainty, e.g., in R t and reporting. By comparison, the two-step approach of first transforming the observed time series and then calculating R t requires users to propagate uncertainty from the back-calculation step into the R t estimation step. A final advantage of latent state methods is that they could in theory facilitate inference from multiple data streams simultaneously. For example, by assuming that cases, hospitalizations, and deaths all arise from a common infection process, these methods might be able to infer the incident time series of infections more accurately and precisely, potentially while also estimating delays and changes in ascertainment for specific data sources (e.g., outpatient cases).
</p>
<p>Deconvolution or R t estimation methods that include a forward observation process are particularly useful when delays to observation are relatively long and variable, and in analyses that require accurate inference of the timing and speed of changes in R t . If delays to observation are relatively short, or if R t is not substantially changing, then deconvolution may not be necessary. For example, when working with synthetic case data in which the mean delays to observation are short and known accurately, the underlying infection curve (Fig. 5A) and underlying R t values (Fig. 5C) can be recovered with reasonable accuracy simply by shifting the observed time series. But longer and more variable delays to observation worsen inference of the underlying incidence curve (Fig. 5B). In turn, this makes it more difficult to infer the speed and timing of abrupt changes in R t and to relate those changes to policies, behaviors or other extrinsic epidemic drivers at specific points in time. For example, simply shifting a times series of observed deaths by the mean delay does not accurately recover the underlying curves of infections or R t (Fig. 5B,C). The marginal value of deconvolution or other methods that infer the unobserved time series of infections is greater when delays to observation are longer and more variable, and when R t is changing.</p>
<p>Another advantage of working with observations nearer the time of infection, such as times of symptom onset among newly symptomatic individuals, is that they provide more information about recent transmission events and therefore allow R t to be estimated in closer to real-time (Fig. 5C) [46]. Of course, this advantage could be offset by sampling biases and reporting delays. Users will need to balance data quality with the length of the observation delay when selecting inputs.</p>
<p>Further investigation is needed to determine the best methods for inferring infections from observations if the underlying delay distribution is uncertain. If the delay distribution is severely misspecified, all three approaches (deconvolution, shifting by the mean delay, or convolution) will incorrectly infer the timing of changes in incidence. In August 27, 2020 13/25</p>
<p>this case, methods such as deconvolution or shifting by the mean delay might more accurately estimate the magnitude of changes in R t but at the cost of spurious precision in the inferred timing of those changes. Ideally, the delay distribution could be inferred jointly with the underlying times of infection or estimated as the sum of the incubation period distribution and the distribution of delays from symptom onset to observation (e.g. from line-list data).</p>
<p>• Estimating the instantaneous reproductive number requires data on the number of new infections (i.e., transmission events) over time. These inputs must be inferred from observations using assumptions about delays between infection and observation.</p>
<p>• Inferring the unlagged time series of infections using deconvolution, or within an R t estimation model that includes forward delays, can improve accuracy.</p>
<p>• A less accurate but simpler approach is to shift the observed time series by the mean delay to observation. If the delay to observation is not highly variable, and if the mean delay is known exactly, the error of this approach may be tolerable. A key disadvantage is that shifting by a fixed amount of time does not account for uncertainty or individual variation in delay times.</p>
<p>• Sampling from the delay distribution to impute individual times of infection from times of observation accounts for uncertainty but blurs peaks and valleys in the underlying incidence curve, which in turn compromises the ability to rapidly detect changes in R t .</p>
<p>Near real-time estimation requires not only inferring times of infection from the observed data but also adjusting for missing observations of recent infections. The absence of recent infections is known as "right truncation". Without adjustment for right truncation, the number of recent infections will appear artificially low because they have not yet been reported [4,30,[51][52][53][54][55]. Thus, adjusting for right truncation is particularly important in analyses with the goal of near real-time R t estimation.</p>
<p>Figure 5 illustrates the consequences of failure to adjust for right truncation when inferring times of infection from observations. Subtracting the mean observation delay m from times of observation ("shift" method in Fig. 5A,B) leaves a gap of m days between the last date in the inferred infection time series and the last date in the observed data. This hampers recent R t estimation (Fig. 5C). Inferring the underlying times of infection by subtracting samples from the delay distribution ("convolve" method in Fig. 5A,B) dramatically underestimates the number of infections occurring in the last few days of the time series.</p>
<p>The simplest approach is to drop estimates on the last few dates, or to flag them as unreliable [8]. But many methods are available to adjust for right truncation, which can improve real-time analysis [41,[51][52][53][54][55][56]. These methods infer based on past reporting delays the total number of infections, observed and not-yet-observed, at the end of the time series.</p>
<p>In short, accurate near real-time R t estimation requires both inferring the infection time series from recent observations and adjusting for right truncation. Errors in either step could amplify errors in the other. Joint inference approaches for near real-time R t estimation, which simultaneously infer times of infection and adjust for right truncation, are now in development [41].</p>
<p>August 27, 2020 14/25</p>
<p>• At the end of a truncated time series, some infections will not yet have been observed. Infer the missing data to obtain accurate recent R t estimates.</p>
<p>The effect of incomplete case observation on R t estimation depends on the observation process. If the fraction of infections observed is constant over time, R t point estimates will remain accurate and unbiased despite incomplete observation [12,14,43,57,58].</p>
<p>Data obtained from carefully designed surveillance programs might meet these criteria. But even in this best-case scenario, because the estimation methods reviewed here assume all infections are observed, confidence or credible intervals obtained using these methods will not include uncertainty from incomplete observation. Without these statistical adjustments, practitioners and policy makers should beware false precision in reported R t estimates.</p>
<p>Sampling biases will also bias R t estimates [57]. COVID-19 test availability, testing criteria, interest in testing, and even the fraction of deaths reported [59] have all changed over time. If these biases are well understood, it might be possible to adjust for them when estimating R t . Observed hospitalizations and deaths may be less sensitive to changes in test availability and testing effort, but may be more sensitive to other factors, such as hospital bed availability. Hospitalizations and deaths will also vary in their representativeness of mean transmission rates, depending on which age groups are being infected. No matter what data is used, one potential solution is to flag R t estimates as potentially biased in the few weeks following known changes in data collection or reporting. At a minimum, practitioners and policy makers should understand how the data underlying R t estimates were generated and whether they were collected under a standardized testing protocol.</p>
<p>• R t point estimates will remain accurate given imperfect observation of cases if the fraction of cases observed is time-independent and representative of a defined population. But even in this best-case scenario, confidence or credible intervals will not accurately measure uncertainty from imperfect observation.</p>
<p>• Changes over time in the type or fraction of infections observed can bias R t estimates. Structured surveillance with fixed testing protocols can reduce or eliminate this problem.</p>
<p>Because R t estimators incorrectly assume all infections are observed, day-of-week reporting effects and stochasticity in the number of observations per day can cause spurious variability in R t estimates, especially if the number of observations per day is low [14]. The Cori method incorporates a sliding window to smooth R t estimates, but the size of the smoothing window can affect both the temporal and quantitative accuracy of estimates. Larger windows effectively increase sample size by drawing information from multiple time points but blur what may be biologically meaningful changes in R t . Some smoothing approaches can also cause R t estimates to lead or lag the true value (Fig. 6).</p>
<p>August 27, 2020 15/25</p>
<p>Lags can be particularly severe when using the conventions suggested by Cori et al., in which R t is reported on the last date in a given window, rather than on the middle date. Although this convention returns R t estimates to the last date in the time series, which is convenient for real-time estimation, R t estimates reported at the end of a window are based entirely on data from the past and therefore lag the instantaneous R t (Fig 6B). Instead, we recommend reporting R t at the midpoint of the smoothing window (Fig 6A ), which produces estimates that are more accurately oriented in time. An apparent disadvantage is that a centered window precludes R t estimation on the last w/2 time units, where w is the width of the window. However, we argue that temporal accuracy is preferable, and that if daily counts are low, failure to produce estimates on the last few days in the time series realistically acknowledges uncertainty about recent trends. Thus, for SARS-CoV-2 and other pathogens with short timescales of infection, near real-time R t estimation requires large enough daily counts to permit a small window (e.g., a few days). Although the sliding window increases statistical power to infer R t , it does not by itself accurately calculate confidence intervals. Thus, underfitting and overfitting are possible. The risk of overfitting in the Cori method is determined by the length of the time window that is chosen. In other words, there is a trade-off in window length between picking up noise with very short windows and over-smoothing with very long ones. To avoid this, one can choose the window size based on short-term predictive accuracy, for example using leave-future-out validation to minimize the one-step-ahead log score [60]. Proper scoring rules such as the Ranked Probability Score can be used in the same way, and a time-varying window size can be chosen adaptively [41].</p>
<p>August 27, 2020 16/25</p>
<p>• If R t appears to vary abruptly due to underreporting, a wide smoothing window can help resolve R t . However, wider windows can also lead to lagged or inaccurate R t estimates.</p>
<p>• If a wide smoothing window is needed, consider reporting R t for t corresponding to the middle of the window.</p>
<p>• To avoid overfitting, choose a smoothing window based on short-term predictive accuracy [60] or use an adaptive window [41].</p>
<p>We tested the accuracy of several methods for R t estimation in near real-time and recommend the methods of Cori et al. [14], which are currently implemented in the
<rs xml:id="12894711" type="software" subtype="environment">R</rs> package
<rs xml:id="12894712" type="software" subtype="component" corresp="12894711">EpiEstim</rs> <rs xml:id="12953678" type="bibr">[20]</rs>. The Cori et al. method estimates the instantaneous rather than the case reproductive number and is conceptually appropriate for near real-time estimation. The method uses minimal parametric assumptions about the underlying epidemic process and can accurately estimate abrupt changes in the instantaneous reproductive number using ideal, synthetic data.
</p>
<p>Most epidemiological data are not ideal, and statistical adjustments are needed to obtain accurate and timely R t estimates. First, to obtain timely and temporally accurate R t estimates, considerable pre-processing is needed to infer the underlying time series of infections (i.e., transmission events) from delayed observations and to adjust for right truncation. Best practices for this inference are still under investigation, especially if the delay distribution is uncertain. The smoothing window must also be chosen carefully, potentially adaptively, and daily counts must be sufficiently high for changes in R t to be resolved on short timescales. To avoid biases in R t estimates, the generation interval distribution must be estimated and specified accurately. Finally, to avoid false precision in R t , uncertainty arising from delays to observation, from adjustment for right truncation, and from imperfect observation must be propagated. The functions provided in the
<rs xml:id="12894714" type="software">EpiEstim</rs> package quantify uncertainty arising from the R t estimation model but currently not from uncertainty arising from imperfect observation or delays.
</p>
<p>Work is ongoing to determine how best to infer infections from observations and to account for all relevant forms of uncertainty when estimating R t . Some useful extensions of the methods provided in
<rs xml:id="12894715" type="software" subtype="component" corresp="12894716">EpiEstim</rs> have already been implemented in the
<rs xml:id="12894716" type="software" subtype="environment">R</rs> package
<rs xml:id="12894717" type="software" subtype="component" corresp="12894716">EpiNow2</rs> [<rs xml:id="12894718" type="bibr">41</rs>,<rs xml:id="12894719" type="bibr">44</rs>], and further updates to this package are planned as new best practices become established.
</p>
<p>But even the most powerful inferential methods, extant and proposed, will fail to estimate R t accurately if changes in sampling are not known and accounted for. If testing shifts from more to less infected subpopulations, or if test availability shifts over time, the resulting changes in case numbers will be ascribed to changes in R t . Thus, structured surveillance also belongs at the foundation of accurate R t estimation. This is an urgent problem for near real-time estimation of R t for COVID-19, as case counts in many regions derive from clinical testing outside any formal surveillance program.</p>
<p>Deaths, which are more reliably sampled, are lagged by 2-3 weeks and still subject to biases in underreporting. The establishment of sentinel populations (e.g., outpatient visits with recent symptom onset) for R t estimation could thus help rapidly identify the effectiveness of different interventions and recent trends in transmission.</p>
<p>reproductive number of the infected population on specific dates, especially when aiming to study how interventions or other extrinsic factors have affected transmission at a given point in time.</p>
<p>observed date are missing terms in the denominator of the Cori et al. estimator, and so the method of Cori et al. often overestimates R t early in the time series.</p>
<p>We are grateful to Michael Höhle for helpful comments. KG was supported by the James S. McDonnell Foundation. LM was supported by the National Institute Of General Medical Sciences of the National Institutes of Health under Award Number F32GM134721. ML acknowledges support from the Morris-Singer Fund and from Models of Infectious Disease Agent Study (MIDAS) cooperative agreement U54GM088558 from the National Institute Of General Medical Sciences. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institute Of General Medical Sciences or the National Institutes of Health. LFW acknowledges support from the National Institutes of Health (R01 GM122876). SA, JH, SM, JM, NIB, KS, RNT, SF acknowledge funding from the</p>
<p>Wellcome Trust (210758/Z/18/Z). Thanks to Christ Church (Oxford) for funding via a Junior Research Fellowship (RNT). This project has been funded in whole or in part with Federal funds from the National Institute of Allergy and Infectious Diseases,</p>
<p>All
<rs xml:id="12894720" type="software" subtype="implicit">code</rs> for analysis and figure generation is available at
<rs xml:id="12894721" type="url" corresp="12894720">https://github.com/cobeylab/Rt estimation</rs>.
</p>
<p>(B) Now consider the times at which these individuals are observed. Logically, t observation = t infected + u, where u is a random variable describing the delay between infection and observation. Mathematically, this is a convolution of the infection time and the delay distribution. Because u has non-zero variance, observation times are not only shifted into the future but also are blurred across many dates. This blurring is biologically realistic; due to variability in disease progression and care seeking, individuals with the same date of infection will not necessarily be observed at the same time. (C) Using the observations in B, we aim to recover the latent times of infection shown in A. Doing so would require not only shifting into the past but also removing the variance introduced by the observation process, which can be achieved by deconvolution. Instead, as demonstrated here, a common strategy is to subtract u from the times of observation, effectively repeating the convolution shown in B, but this time moving backward in time rather than forward. This is not the correct inverse operation. It fails to remove variance introduced by the observation process (the forward convolution) and adds new, biologically unrealistic variance, further blurring the inferred times of infection. (D) Shifting the times of observation by the mean delay E[u] is also incorrect, as it does not remove the variance from the forward convolution in B. But if the mean delay time is known exactly, this approach is preferable to C, as it avoids adding even more variance. Ultimately, deconvolution methods would be needed to recover A from the observations in B while properly accounting for uncertainty. August 27, 2020 18/25</p>
</text>
</tei>