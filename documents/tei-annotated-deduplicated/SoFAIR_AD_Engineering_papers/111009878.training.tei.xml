<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
<teiHeader>
<fileDesc xml:id="_1"/>
<encodingDesc>
<appInfo>
<application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T14:15+0000">
<ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
</application>
</appInfo>
</encodingDesc>
</teiHeader>
<text xml:lang="en">
<p>Anatomical models are important training and teaching tools in the clinical environment and are routinely used in medical imaging research. Advances in segmentation algorithms and increased availability of three-dimensional (3D) printers have made it possible to create costefficient patient-specific models without expert knowledge. We introduce a general workflow that can be used to convert volumetric medical imaging data (as generated by Computer Tomography (CT)) to 3D printed physical models. This process is broken up into three steps: image segmentation, mesh refinement and 3D printing. To lower the barrier to entry and provide the best options when aiming to 3D print an anatomical model from medical images, we provide an overview of relevant free and open-source image segmentation tools as well as 3D printing technologies. We demonstrate the utility of this streamlined workflow by creating models of ribs, liver, and lung using a Fused Deposition Modelling 3D printer.</p>
<p>Anatomical models have applications in clinical training and surgical planning as well as in medical imaging research. In the clinic, the physical interaction with models facilitates learning anatomy and how different structures interact spatially in the body. Simulation-based training with anatomical models reduces the risks of surgical interventions [1], which are directly linked to patient experience and healthcare costs. For example, improvement of central venous catheter insertions has been achieved by the use of anatomically and ultrasonically accurate teaching phantoms [2]. In addition, the phantoms can be used for pre-operative surgical planning, which has been shown to be beneficial in craniofacial surgery [3] and is being explored in a number of other surgical fields [4,5]. Lastly, anatomical phantoms can be designed to mimic tissue when imaged with the modality of interest; most commonly ultrasound, Computed Tomography (CT), or Magnetic Resonance Imaging (MRI). Imaging phantoms are also important for the development of novel imaging modalities such as photoacoustics [6], or for validation of imagebased biomarkers such as pore size estimation using nuclear magnetic resonance [7], where they provide controlled experimental environments.</p>
<p>Anatomically accurate models can be computer-generated from medical image data. CT and MRI are widely used to image biological features, ranging from whole-body imaging to particular areas of interest such as tumours or specific parts of the brain. Depending on the imaging modality, different features can be observed and different image segmentation algorithms will be appropriate. CT pixel intensities directly correlate to tissue density. The modality thus lends itself well to segmenting structures such as bones (high density) or lungs (low density). MRI offers excellent soft tissue contrast, which, for example, enables differentiation between white and grey matter in the brain [8].</p>
<p>Recent advances in segmentation software have made it increasingly easy to automatically or semi-automatically extract the surface of structures of interest from three-dimensional (3D) medical imaging data. This has made it possible to generate anatomical models using a standard personal computer with little prior anatomical knowledge. At the same time 3D printers, traditionally used in industrial applications, are now available for home use thanks to low-cost desktop alternatives. This technology enables fast creation of 3D models without the need for classical manufacturing expertise.</p>
<p>Accessibility to 3D printers and advanced segmentation algorithms have led to an increase in use of 3D printing in medicine, which has received interest due to a multitude of potential medical applications [4,9]. Models can be made patient-specific, and rapidly redesigned and prototyped, providing an inexpensive alternative to generic commercially available anatomical models. 3D printing thus found applications in teaching the structure of kidney [5], heart [10], and liver [11]. A number of studies have also investigated the potential of using 3D printing techniques to produce tissue-mimicking phantoms for research and teaching, with example applications in producing models of vessels [2,12], parts of the skull [13], optic nerves [14], and renal system [15]. The process of going from medical imaging data to 3D printed models has been described for the brain [16,17], the human sinus [18], as well as from a general point of view [19], but challenges remain to make the process widely available to novice users.</p>
<p>In this work, we present a practical guide to creating a broad range of anatomical models from medical imaging data. In the next section, we provide an overview of the general workflow and include a table listing the relevant 3D printing technologies. We have implemented a streamlined processing pipeline on various examples to illustrate the different approaches that can be followed. We have developed 3D printed models of ribs, a liver, and a lung. Ribs and lung were chosen as they have complex structure, while the liver illustrates the potential of segmenting and printing soft-tissue organs which have lower contrast with the surrounding tissue in CT images. Finally, we introduce and discuss the currently freely available segmentation tools, which can be applied to any organ or region of interest.</p>
<p>In this section, we describe the process of going from medical imaging data (CT scan) to a finished 3D printed model from a general point of view. We have implemented a streamlined pipeline on different regions of interest (ribs, liver, and lung), which will be described in the sections below. While the pipeline is illustrated using CT images, it is also applicable to other volumetric medical imaging modalities, like MRI. The workflow is broken down into three steps (Fig 1 ):</p>
<p>Image segmentation. After acquiring a medical image, structures of interest need to be segmented. Image segmentation is the process of partitioning an image into multiple labelled regions locating objects and boundaries in images. It can be used to create patient-specific, highly accurate computer models of organs and tissue. There are a number of image segmentation techniques, which each have advantages and disadvantages, but there is no single segmentation technique which is suitable for all images and applications. Basic segmentation approaches rely on the principle that each tissue type has a characteristic range of pixel intensities. Hence, it is possible to distinguish between tissues and identify boundaries.</p>
<p>There is a wide range of software that is capable of performing image segmentation, ranging from multi-purpose commercial platforms with integrated physics simulations (e.g.
<rs xml:id="12971468" type="software">Mimics</rs> <rs xml:id="12971469" type="bibr">[20]</rs>, or
<rs xml:id="12971470" type="software">Simpleware</rs> <rs xml:id="12971471" type="bibr">[21]</rs>), to open-source tools targeted to specific organs (e.g.
<rs xml:id="12971472" type="software">FreeSurfer</rs> <rs xml:id="12971473" type="bibr">[22]</rs> for the brain). In this work, we have used the freeware software packages called
<rs xml:id="12971474" type="software">Seg3D</rs> <rs xml:id="12971475" type="bibr">[23]</rs> and
<rs xml:id="12971476" type="software">3D Slicer</rs> <rs xml:id="12971477" type="bibr">[24]</rs>, as they are capable of processing a range of medical imaging data. Furthermore, we provide a summary of comparable freeware software available at the time of writing in the discussion.
</p>
<p>Mesh refinement. Following image segmentation, the 3D model can be further refined into a printable 3D mesh. There are a number of computer-aided design tools that can be used for this purpose and allow almost limitless mesh manipulation and refinement. However, the main reasons for such mesh post-processing of the segmentation are as follows:</p>
<p>Repairing: Errors and discontinuities that sometimes arise in the image segmentation and exporting process need to be repaired before printing. Smoothing: Staircasing errors resulting from the resolution of the original medical image can be mitigated by smoothing the surface of the mesh model.</p>
<p>Appending: The segmentation will often only be one component of a final model. To convert the model into a useable form, it is often necessary to combine it with other structures or remove unneeded parts from the segmentation.</p>
<p>3D printing. There are many different 3D printing technologies available, each with their own characteristics. Here we provide an overview of the 3D printing methods, which are suitable for the creation of anatomical models and highlight their respective advantages. The relevant 3D printing technologies can be classified into three groups: extrusion printing, photopolymerisation and powder-based printing. The most common example of extrusion printing is known as Fused Deposition Modelling (FDM), which is based on melting and depositing a material via a nozzle, building the desired shape layer by layer. In photopolymerisation, liquid polymers are selectively cured, typically using UV light. Important examples are Stereolithography (SLA) and Digital Light Processing (DLP), which selectively cure a plastic in a bath. Moreover, the photopolymer can be sprayed onto the print in thin layers, where it is subsequently cured. This technique is known as Material Jetting (MJ). Lastly, in powder-based techniques, a powdered material is bound together. This can either be done using a liquid binding agent (Binder Jetting, BJ), or by fusing the particles together using heat (Selective Laser Sintering, SLS). The characteristics of these techniques are summarised in Table 1.</p>
<p>The models of the ribs and liver were segmented using
<rs xml:id="12971478" type="software">Seg3D</rs> (v.
<rs xml:id="12971479" type="version" corresp="12971478">2.2.1</rs>) while the lung was segmented using
<rs xml:id="12971480" type="software">3D Slicer</rs> (v.
<rs xml:id="12971481" type="version" corresp="12971480">4.6</rs>). We smoothed the models using
<rs xml:id="12971482" type="software">MeshMixer</rs> <rs xml:id="12971483" type="bibr">[27]</rs> (v.
<rs xml:id="12971484" type="version" corresp="12971482">3.0</rs>) and printed all of them using Filament Deposition Modelling (FDM). All processing was done using
Windows 10 as operating system.
</p>
<p>Image segmentation.
<rs xml:id="12971485" type="software">Seg3D</rs> v.
<rs xml:id="12971486" type="version" corresp="12971485">2.2.1</rs> was used to generate the rib model from the CT MECANIX dataset (Siemens Sensation 64, 3 mm slice thickness, 0.56 mm by 0.56 mm pixel size, 120 kV peak kilo-voltage, 100 mAs exposure) available on the <rs xml:id="12971487" type="software">OSIRIX</rs> website <rs xml:id="12971488" type="bibr">[28]</rs>. The ribs were segmented using thresholding, manual modification (cropping), a connected-component-filter as well as a fill-holes-filter. The segmentation was exported as a stereolithography (STL) file using the "Export Isosurface" command. • Rippled and porous surface • Fragile along z-axis
</p>
<p>• Kidney [15] • Liver [11] • Sinus [13,18] Photopolymerisation: Stereolithography (SLA) &amp; Digital Light Processing (DLP)</p>
<p>• Moderate cost • Good surface finish / high resolution • Prints are prone to slight distortions • Curing resins need to be handled with care</p>
<p>• Prosthetics [9] Photopolymerisation: Material Jetting (MJ)</p>
<p>• Very good surface finish / high resolution • Ability to gradually combine different polymers • High material cost • Curing resins need to be handled with care</p>
<p>• Vessels [12,25] • Spine [26] Powder Binding: Binder Jetting (BJ) • Brain [16] • Heart [10] https://doi.org/10.1371/journal.pone.0178540.t001 <rs xml:id="12971489" type="software">3D
Slicer</rs> v.
<rs xml:id="12971490" type="version" corresp="12971489">4.6</rs> was used to create a model of the liver and the right lung from the CT ARTI-FIX dataset (Siemens Sensation 64, 1.5 mm slice thickness, 0.59 mm by 0.59 mm pixel size, 120 kV peak kilo-voltage, 300 mAs exposure) from the
<rs xml:id="12971491" type="software">OSIRIX</rs> website <rs xml:id="12971492" type="bibr">[28]</rs>. This was done using the level tracing algorithm as well as manual modification. After segmentation, the "make model" tool was used to export the volume as a STL file.
</p>
<p>Mesh refinement. The ribs model was refined using
<rs xml:id="12971493" type="software">Meshmixer</rs> to improve its topology. This was done by adjusting the mesh density of the surface and by applying a global smoothing filter that removes step artefacts due to the finite voxel size. Furthermore, we have used
<rs xml:id="12971494" type="software">Free-CAD</rs> (v.
<rs xml:id="12971495" type="version" corresp="12971494">0.16</rs>) <rs xml:id="12971496" type="bibr">[29]</rs> to design a holder for a tissue phantom. As
<rs xml:id="12971497" type="software">FreeCAD</rs> has limitations working with large mesh files, the holder was attached to the ribs model structure in another software package called
<rs xml:id="12971498" type="software">Blender</rs> (v.
<rs xml:id="12971499" type="version" corresp="12971498">2.6</rs>) <rs xml:id="12971500" type="bibr">[30]</rs>.
</p>
<p>The lung model was also smoothed using
<rs xml:id="12971501" type="software">MeshMixer</rs>. The different segmentation method demanded a local smoothing approach utilising the "RobustSmooth" brush provided by the software. Furthermore, the "Flatten" and "Inflate" brushes were used to remove unphysiological holes in the model.
</p>
<p>The smoothing of the liver was also done utilizing both a global smoothing filter as well as the "RobustSmooth" brush tool.</p>
<p>3D printing. We have used an Ultimaker 2 (Ultimaker, Chorley, England) FDM printer to create our models. They were prepared for the printer using the open-source slicing software
<rs xml:id="12971502" type="software">Cura</rs> (v.
<rs xml:id="12971503" type="version" corresp="12971502">15.04.6</rs>), which is provided for free by Ultimaker. All models were printed with a layer height of 0.12 mm and a shell, bottom, and top thickness of 0.8 mm with a nozzle size of 0.4 mm. The prints were created at 20% infill, except for the rib model, which was printed with 100% infill to be functionally similar to bone when viewed under a medical ultrasound scanner (Siemens Acuson S1000 with a 16 MHz ultrasound probe). The material used for printing was "enhanced Polymax" polylactic acid (PLA) (PolyMax; Polymakr, Changshu, China). To estimate the print accuracy, the dimensions of the models were quantified at different sites in silico using
<rs xml:id="12971504" type="software">Meshmixer</rs> and compared to the dimensions of the 3D prints, which were measured using calipers and a micrometer.
</p>
<p>The 3D printed models of the ribs, liver and lung can be seen in Fig 2 . On the ribs phantom the holder can be seen, which can be used to place tissue mimicking phantoms underneath the ribs in order to perform realistic ultrasound imaging experiments and training. The liver phantom was printed in coloured PLA, while the lung was painted using acrylic colour to be used as a teaching model.</p>
<p>The print duration for lung, ribs, and liver were 43h, 87.5h, and 27.5h respectively. The cost of the PLA for each of the models was approximately £16, £25, and £10 respectively. The print accuracy of the models is summarised in Table 2.</p>
<p>The ribs phantom was used as an ultrasound imaging phantom for clinical training. By embedding the ribs into a mineral-oil based material (Mindsets, Waltham Cross, United Kingdom) to simulate surrounding musculature and soft tissues, and combining these with a chicken breast and an 18 gauge puncture needle, it was possible to perform a low-cost mock kidney fine needle aspiration (FNA) procedure (Fig 3) [31]. In Fig 3B, the reflection of part of the ribs phantom can be seen in the top right corner. The artificial ribs are creating a shadowing effect which can also be observed in real ultrasound imaging procedures. When going from medical imaging data to 3D printed anatomical models, the choice of an appropriate image segmentation algorithm is arguably the most important step. An overview of relevant freeware segmentation tools can be seen in Table 3. We have illustrated the use of two different open-source tools, which offer a multitude of ways to achieve accurate segmentation.</p>
<p>
<rs xml:id="12971505" type="software">Seg3D</rs> has both manual and automatic segmentation tools and provides a library of addons with additional algorithms and applications optimised for particular segmentation applications. A key feature is that the interface makes it possible to visualise images in 3D with multiple volumes managed as layers. This facilitates the manipulation of several segmentations, which is particularly useful when it is necessary to use a combination of segmentation techniques to obtain the final surface. For example, the images may be cropped prior to more advanced segmentation processes in order to isolate the volume of interest. Furthermore, it provides Boolean transforms to combine multiple segmentations into a single surface.
<rs xml:id="12971506" type="software">Seg3D</rs> also provides the option of exporting the final segmentation to the STL file format.
</p>
<p>
<rs xml:id="12971507" type="software">3D Slicer</rs> has a multitude of other image manipulation options and can be used to register different scans to each other. Because the large range of tools provided by the software, the interface is more difficult to master. However, it provides a range of powerful segmentation algorithms and has a unique selection of extensions available, which can be utilised for more specific tasks.
</p>
<p>The segmentations formed the basis of the 3D printed models, which we created using FDM, allowing easy, low-cost creation of anatomical models. It was possible to create the segmented structures with high detail, allowing them to be used as teaching models. Furthermore, the printed model of the ribs was found to be functionally close to a real rib cage when imaged by an ultrasound scanner [31].</p>
<p>Using FDM for the creation of anatomical models has limitations inherent to the printing technique: The surface of the models was rough and rigid, which is not a realistic representation of the real tissue, and support material has to be carefully removed without damaging the finished print. However, there is flexible PLA available and the model surface can be smoothed using 3D print coatings (e.g. XTC-3D by Smooth-On, Macungie, USA). An alternative approach is to use a material jetting technique, which can combine different polymers seamlessly in one print, offering the possibility of creating a gradient of flexibility.</p>
<p>We have introduced a general workflow that can be used to generate 3D printed anatomical models from medical imaging data. This streamlined pipeline is applicable for volumetric medical imaging data and works for a wide variety of organs and other anatomical regions of interest. We have demonstrated its use in the creation of models of ribs, a liver and a lung from CT datasets.</p>
<p>Recent developments in image segmentation algorithms have enabled the use of a multitude of tools and strategies in delineating anatomical structures of interest. We have provided an overview of the most relevant open-source tools that can be used for anatomical structure segmentation by end-users who are not medical or image processing specialists.</p>
<p>Future work will focus on creating flexible phantoms and exploring different materials with regard to their tissue mimicking characteristics in US and MRI systems.</p>
<p>https://doi.org/10.1371/journal.pone.0178540.t003</p>
<p>PLOS ONE | https://doi.org/10.1371/journal.pone.0178540May 31, 2017</p>
<p>The authors wish to thank Eve Hatten and George Dwyer for technical support and wish to thank Elliott Magee, Nishat Ahmed, Shehzaad Chikte, Ferran Prados, and Tom Vercauteren for insightful discussions.</p>
<p>University College London Changemakers (https://www.ucl.ac.uk/ changemakers) funded DIN, TMB, ERH, JLR, and EM. The funders had no role in study design, data collection and analysis, decision to publish or preparation of the manuscript.</p>
<p>The datasets used in this publication ("
MECANIX" and "
ARTIFIX" from the
Osirix Website:
http://www.osirix-viewer.com/ resources/dicom-image-library/) were freely available at the time of writing.
<rs xml:id="12971508" type="software">Osirix</rs> has since changed access rights and requires a paid membership. As such, we are not authorised to distribute the datasets used for this study. However, the data is still publicly available but not free of charge.
</p>
<p>Conceptualization: DIN.</p>
</text>
</tei>