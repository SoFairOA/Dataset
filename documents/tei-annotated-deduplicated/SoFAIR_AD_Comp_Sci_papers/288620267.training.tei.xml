<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
<teiHeader>
<fileDesc xml:id="_1"/>
<encodingDesc>
<appInfo>
<application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T11:31+0000">
<ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
</application>
</appInfo>
</encodingDesc>
</teiHeader>
<text xml:lang="en">
<p>Ligand binding affinity calculations based on molecular dynamics (MD) simulations and non-physical (alchemical) thermodynamic cycles have shown great promise for structure-based drug design.</p>
<p>However, their broad uptake and impact is held back by the notoriously complex setup of the calculations. Only a few tools other than the free energy perturbation approach by Schr ödinger Inc.</p>
<p>(referred to as FEP+) currently enable end-to-end application. Here, we present for the first time an approach based on the open-source software
<rs xml:id="12966002" type="software">pmx</rs> that allows to easily set up and run alchemical calculations for diverse sets of small molecules using the
<rs xml:id="12966003" type="software">GROMACS</rs> MD engine. The method relies on theoretically rigorous non-equilibrium thermodynamic integration (TI) foundations, and its flexibility allows calculations with multiple force fields. In this study, results from the <rs xml:id="12966004" type="software">Amber</rs> and <rs xml:id="12966005" type="software">Charmm</rs> force fields were combined to yield a consensus outcome performing on par with the commercial FEP+ approach. A large dataset of 482 perturbations from 13 different protein-ligand datasets led to an average unsigned error (AUE) of 3.64 AE 0.14 kJ mol À1 , equivalent to Schr ödinger's FEP+ AUE of 3.66 AE 0.14 kJ mol À1 . For the first time, a setup is presented for overall high precision and high accuracy relative protein-ligand alchemical free energy calculations based on open-source software.
</p>
<p>The lead optimization (LO) stage of drug discovery involves the synthesis of hundreds of lead compound analogs, with the aim to improve multiple properties in parallel. Among these are selectivity against related targets, enhanced metabolic stability, permeability, solubility, reduced side effects, efflux, and plasma protein binding. Thus, LO is a multi-objective optimization problem in which chemists try to identify structure-property relationships that will allow to tune the chemical and biophysical properties of the lead compound. Ligand binding affinity for the primary protein target is central to all LO efforts as it impacts drug efficacy, and thus its dose and selectivity margins versus off-target effects. Computationally-driven guidance to LO requires precision and accuracy, and the predictive power of empirical scoring functions alone is rarely enough at this stage of drug discovery. [1][2][3][4] For this data-scarce yet multiparameter problem it remains to be seen if data-driven methods are able to predict new primary target activities. On the other hand, an approach that has shown the required level of performance is alchemical relative binding free energy (RBFE) calculations based on molecular dynamics (MD) simulations. [5][6][7] Free energy perturbation (FEP) 8,9 and thermodynamic integration (TI) 10 are popular methods used for alchemical RBFE estimation. The application of FEP in alchemical calculations dates back several decades and it typically uses molecular dynamics (MD) or Monte Carlo simulations to compute the freeenergy difference between two structurally related ligands, making it ideal for LO. [11][12][13][14][15] Equilibrium FEP is arguably the most common implementation of alchemical calculations and involves many distinct equilibrium MD simulations for all states along a l coordinate that alchemically modies the rst ligand into the second. It is common to use 12, 15 or more socalled l intermediates wherein atoms that need to appear, disappear, or mutate between the two ligands are represented by a linear combination of end-state Hamiltonians. During alchemical transformations, van der Waals and sometimes electrostatic interactions are soened to avoid singularities and numerical instabilities. [16][17][18] Various methods exist to calculate the free energy associated with a change of the l coordinate, but a requisite for convergence is an overlap in conformational space between neighboring simulations along the l path. TI differs from FEP in the way free energy difference is calculated as a function of l: integration of the derivative of the Hamiltonian with respect to l results in the free energy difference between end states. For FEP, if 1, 5 or 10 ns trajectories are required per l window in both solvent and complex the computation becomes expensive when performing hundreds or thousands of perturbations in a drug discovery LO program. Recently, however, this cost has been dramatically reduced by using graphics processing units (GPU) or massively parallel resources. [19][20][21] For instance, Schrödinger's FEP+ 3 implementation uses the GPU-enabled MD-engine Desmond. 22 This has led to an explosion of interest in this approach. In turn, application of FEP to a vast range of protein-ligand systems revealed that the method can indeed deliver accurate relative binding affinity predictions with an error of &lt;1 kcal mol À1 with respect to experiment. [23][24][25][26][27][28][29][30][31][32][33][34][35][36] However, the application of FEP using most MD soware remains challenging, preventing its widescale uptake.</p>
<p>Contrary to naturally-occurring amino acids, small molecules cover an almost innite chemical space. Hence, deriving appropriate force eld parameters for ligands can itself be challenging, and several recent reports address this. [37][38][39] The challenge in the RBFE calculations setup is to automatically recognize the structural differences between the ligands and prepare a sensible hybrid topology for MD simulations. Several programs that help with this [40][41][42][43] and other steps in the process 44,45 have been reported. Work from the de Groot lab has led to the development of <rs xml:id="12966006" type="software">pmx</rs>, <rs xml:id="12966007" type="bibr">46</rs>,<rs xml:id="12966008" type="bibr">47</rs> a tool to prepare inputs for alchemical free energy calculations 48 in <rs xml:id="12966009" type="software">GROMACS</rs>. <rs xml:id="12966010" type="bibr">49</rs> So far, <rs xml:id="12966011" type="software">pmx</rs> has delivered accurate results for the prediction of the effect of protein mutations on thermodynamic stabilities, 27,35,50,51 changes in protein-protein interaction free energies, 27 shis in the equilibria between protein conformational substates, 52 as well as DNA nucleotide mutations. 29 In this report, we demonstrate the rst application of <rs xml:id="12966012" type="software">pmx</rs> to relative protein-ligand binding free energies.</p>
<p>In our approach, <rs xml:id="12966013" type="software">pmx</rs> is used to identify optimal mappings between ligand atoms and generate hybrid structures and topologies for subsequent GROMACS-based free energy calculations. In contrast to the typical FEP approach based on equilibrium sampling described above, we estimate free energy differences with alchemical non-equilibrium transitions using a TI approach. Equilibrium simulations are rst performed on the ligand-bound and -unbound states; then, short non-equilibrium simulations are used to perturb the ligands. Hundreds of short perturbations can be performed in the forward and backward direction, starting from snapshots covering the conformational space sampled from the equilibrated end states. The resulting free energy difference is derived from the overlap of work distributions associated with the forward and backward transitions using the Crooks Fluctuation Theorem. 53 A primary feature that discriminates between equilibrium and non-equilibrium alchemical approaches is the amount of sampling performed at the physical end states. Equilibrium FEP employs a number of intermediate non-physical simulations along the alchemical path and only two simulations sample the physical end states. The free energy difference of interest is, however, solely dened by the end statesin fact, the role of the intermediate states is merely to ensure a converged DG estimate. The non-equilibrium approach, in contrast, invests more sampling time in the end states, as only very short simulations in alchemical space are performed to connect the physical end states. In a few studies, the efficiency of the non-equilibrium approaches was compared to that of equilibrium methods. However, which of the two approaches is more efficient in practice is yet to be determined conclusively. For example, Ytreberg et al. 54 and Goette and Grubmüller 55 found bidirectional non-equilibrium approaches to be more efficient than equilibrium FEP. In contrast, Yildirim et al. 56 found equilibrium FEP to be more efficient; however, criticism of this study with respect to how efficiency was dened was expressed. 57 Notwithstanding the lack of consensus in the scientic community on this matter, our non-equilibrium protocols 58,59 have already provided high-accuracy predictions in a number of applications involving amino acid and nucleotide mutations. 27,29,34,35,59,60 Here, we use <rs xml:id="12966014" type="software">pmx</rs> to calculate the difference in binding free energy for 482 ligand perturbations across 13 different ligandprotein activity datasets in two contemporary force elds. The calculated free energy differences were combined into a consensus estimate from the results of both force elds providing further increase in accuracy. In this case the consensus approach consists of a simple averaging, but future extensions may also involve more sophisticated schemes, e.g. employing machine learning approaches to assign different weights to force elds. 27 We also used the commercial FEP+ implementation from Schrödinger as a state-of-the-art comparison. This is one of the largest protein ligand relative free energy calculation studies to date, and amongst the rst providing a large-scale comparison of implementations on different MD-engine soware. 61 The overall average unsigned error (AUE) of the predicted DDG was 3.64 AE 0.14 kJ mol À1 with <rs xml:id="12966015" type="software">pmx</rs> and 3.66 AE 0.14 kJ mol À1 with FEP+. The <rs xml:id="12966016" type="software">pmx</rs> tool is freely available at <rs xml:id="12966017" type="url" corresp="12966016">https://github.com/deGrootLab/pmx</rs>.</p>
<p>To help comparison with the prior literature, we selected benchmark sets studied in previous FEP reports. These included the 8 datasets from Wang et al.: 3 JNK1, TYK2, BACE, MCL1, CDK2, Thrombin, PTP1B, and P38. Furthermore, we included protein-ligand systems that have appeared in subsequent FEP studies: Galectin-3, 62 PDE2, 33 cMET 63 (from: https://github.com/ choderalab/yank-benchmark) and two additional BACE datasets. 26,28,64 This provided a total of 482 perturbations with experimental DDG values ranging from À20.7 to 15.4 kJ mol À1 . sidechains, and loops were modelled, protein protonation states were assigned with <rs xml:id="12966018" type="software">PROPKA</rs> at pH 7.0, metals were retained and zero bond order constraints to neighboring atoms were assigned, the hydrogen bonding network was optimized and the ligand charges were assigned. To relieve local clashes, a restrained minimization was performed with a 0.5 Å heavyatom RMSD displacement cut-off, below which the minimization was terminated. FEP+ calculations were performed using <rs xml:id="12966019" type="version" corresp="12966021">v2018-1</rs> of the
<rs xml:id="12966020" type="publisher" corresp="12966021">Schrödinger</rs> <rs xml:id="12966021" type="software" subtype="implicit">modeling suite</rs>. The OPLS v3 force eld, the Desmond (MD) engine v3.8.5, the replica exchange with solute tempering (REST-2), 65 and the multistate Bennett acceptance ratio (MBAR) approach to obtain free energy estimates, 9 were used. The REST region was applied only to ligand heavy atoms. Missing force eld parameters were added by tting to QM calculations using the uilder module. The FEP+ calculations were performed with 12 l-windows and 5 ns of production MD simulations per window. Equilibration was performed in ve steps: (i) 100 ps at 10 K with Brownian dynamics, NVT ensemble, solute heavy atom restraints and small (1 fs) timestep; (ii) 12 ps at 10 K with Berendsen thermostat, NVT ensemble, solute heavy atom restraints and small timestep; (iii) 12 ps at 10 K with Berendsen, NPT ensemble, solute heavy atom restraints, increase to default timesteps; (iv) 24 ps at 300 K with Berendsen, NPT ensemble, solute heavy atom restraints; (v) nally, 240 ps at 300 K with Berendsen, NPT ensemble and no restraints. Production simulations used the NPT ensemble and hydrogen mass repartitioning to permit a 4 fs timestep. Calculations were performed as three independent repeats using different random seeds. Error bars in the gures represent the standard error of DDG across the three repeats and the uncertainty reported by the MBAR estimator.
</p>
<p>The initial ligand and protein structures were taken from the setup of the FEP+ approach. The necessary atom and residue naming adjustments, as well as modications of the nonstandard amino acid residues, were made for compatibility with the <rs xml:id="12966022" type="software">GROMACS</rs> naming convention. Ligand parameterization used the <rs xml:id="12966023" type="software">General Amber Force Field</rs> <rs xml:id="12966024" type="bibr">66</rs> (<rs xml:id="12966025" type="software">GAFF</rs> v
<rs xml:id="12966026" type="version" corresp="12966025">2.1</rs>) and the
<rs xml:id="12966027" type="software">CHARMM General Force Field</rs> <rs xml:id="12966028" type="bibr">67</rs> (
<rs xml:id="12966029" type="software">CGenFF</rs> v
<rs xml:id="12966030" type="version" corresp="12966029">3.0.1</rs> and v
<rs xml:id="12966031" type="version" corresp="12966029">4.1</rs>). For the <rs xml:id="12966032" type="software">GAFF</rs> parameter assignment, the
<rs xml:id="12966033" type="software">ACPYPE</rs> <rs xml:id="12966034" type="bibr">68</rs> and
<rs xml:id="12966035" type="software">Antechamber</rs> <rs xml:id="12966036" type="bibr">69</rs> tools were used. The AM1-BCC 70 charge model was used in combination with the
<rs xml:id="12966037" type="software">GAFF</rs> parameters.
<rs xml:id="12966038" type="software">CGenFF</rs> parameters were assigned using the automated atom-typing toolset
<rs xml:id="12966039" type="software">MATCH</rs> <rs xml:id="12966040" type="bibr">71</rs> and replacing the bonded-parameters with those in
<rs xml:id="12966041" type="software">CGenFF</rs> v
<rs xml:id="12966042" type="version" corresp="12966041">3.0.1</rs>. For the BACE inhibitor sets, the <rs xml:id="12966043" type="software">MATCH</rs> algorithm was unable to identify the appropriate atom types, therefore in these cases a web-based atom-typing and parameter assignment server 72,73 was used. For the BACE inhibitors, the <rs xml:id="12966044" type="software">CGenFF</rs> v<rs xml:id="12966045" type="version" corresp="12966044">4.1</rs> bonded parameters were used. Ligands containing chlorine and bromine were decorated with virtual particles carrying a small positive charge, following the rules for <rs xml:id="12966046" type="software">GAFF</rs> <rs xml:id="12966047" type="bibr">74</rs> and <rs xml:id="12966048" type="software">CGenFF</rs>. <rs xml:id="12966049" type="bibr">75</rs> Having parameterized the ligands, hybrid structures and topologies for the ligand pairs were generated using <rs xml:id="12966050" type="software">pmx</rs>. A mapping between the atoms of two molecules was established following a predened set of rules to ensure minimal perturbation and system stability during the simulations. <rs xml:id="12966051" type="software">pmx</rs> follows a sequential, dual mapping approach. In the rst step, <rs xml:id="12966052" type="software">pmx</rs> identies the maximum common substructure between the two molecules and proposes this as a basis for mapping. In the second step, <rs xml:id="12966053" type="software">pmx</rs> superimposes the molecules and suggests a mapping based on the inter-atomic distances. Finally, the mapping with more atoms identied for direct morphing between the ligands is selected. Additionally, <rs xml:id="12966054" type="software">pmx</rs> ensures that no ring breaking and disconnected fragments in the mapping occur. The obtained mapping is used to create hybrid structures and topologies following a single topology approach.
</p>
<p>The simulation systems for the solvated ligands and ligandprotein complexes were prepared by placing the molecules in dodecahedral boxes with at least 1.5 nm distance to the box walls. The TIP3P water model 76 was used to solvate the molecules. Sodium and chloride ions were added to neutralize the systems and reach 150 mM salt concentration. Proteins were parameterized in two different force elds: Amber99sb*ILDN [77][78][79] and CHARMM36m. 80 Ion parameters by Joung &amp; Cheatham 81 were used for simulations in <rs xml:id="12966055" type="software">Amber</rs>/<rs xml:id="12966056" type="software">GAFF</rs> force eld; <rs xml:id="12966057" type="software">Charmm</rs>/<rs xml:id="12966058" type="software">CGenFF</rs> simulations were performed with the default <rs xml:id="12966059" type="software">Charmm</rs> ion parameters.</p>
<p>For every pair of ligands, the prepared systems were simulated in their physical state A and state B, representing ligand 1 and ligand 2, respectively. Firstly, the systems were energy minimized, followed by a 10 ps equilibration in the NVT ensemble at a temperature of 298 K. Aerwards, the production runs were performed for 6 ns in the NPT ensemble at 298 K and a pressure of 1 bar. Subsequently, 80 snapshots were extracted equidistantly from each of the trajectories generated, aer discarding the rst 2 ns accounting for the system equilibration. From each extracted conguration, an alchemical transition was started (from A to B and vice versa). Every transition was performed in 50 ps. This procedure adds up to 20 ns of simulation time invested to calculate one free energy difference for the ligand in its bound/solvated state. We used 3 replicas of every DDG calculation, in total investing 60 ns for one DG estimate, which is equivalent to the simulation time employed by one repeat of the FEP+ approach.</p>
<p>The temperature in the simulations was controlled by the velocity rescaling thermostat 82 with a time constant of 0.1 ps. The pressure was kept at 1 bar by means of the Parrinello-Rahman barostat 83 with a time constant of 5 ps. All bond lengths were constrained using the LINCS algorithm. 84 Particle Mesh Ewald (PME) 85,86 was used to treat long-range electrostatics: a direct space cutoff of 1.1 nm and a Fourier grid spacing of 0.12 nm were used, and the relative strength of the interactions at the cutoff was set to 10 À5 . The van der Waals interactions were smoothly switched off between 1.0 and 1.1 nm. A dispersion correction for energy and pressure was used. For the alchemical transitions the non-bonded interactions were treated with a modied so-core potential. 18 For every transition, the derivatives of the Hamiltonian with respect to the l parameter were recorded and subsequently used to obtain the work associated with each transition. The maximum likelihood estimator 87 based on the Crooks Fluctuation Theorem 53 was used to relate the non-equilibrium work distributions to the equilibrium free energy differences. The standard errors of the DG estimates were obtained by bootstrap. These were propagated when calculating the DDG values for the individual and consensus force eld results. The consensus approach comprises averaging the estimated DDG values from different force elds and multiple replicas, where every replica encompasses the full free energy calculation procedure including equilibration, production and transition runs.</p>
<p>The double free energy differences (DDG) were compared to experimental measurements by calculating average unsigned errors (AUE), Pearson correlation coefficients, and the percentage of estimates deviating from experiment by less than 1 kcal mol À1 (4.184 kJ mol À1 ). The errors for these observables were bootstrapped and reect the variability in the datasets analyzed.</p>
<p>Overall performance of the non-equilibrium free energy calculations Double free energy differences (DDG) were calculated for a set of 482 ligand modications across 13 protein-ligand datasets. This large set of diverse modications allows for a reliable comparison between the investigated alchemical approaches. Fig. 1A summarizes the main ndings: in absolute terms (average unsigned error, AUE), the pmx-based non-equilibrium free energy calculations perform equivalently to the state-of-theart FEP+ approach. Predictions of both approaches, on average, deviate from experiment by less than 1 kcal mol À1 (4.184 kJ mol À1 ). The individual force elds, <rs xml:id="12966060" type="software">GAFF</rs> and <rs xml:id="12966061" type="software">CGenFF</rs>, are outperformed by FEP+ using the proprietary OPLSv3 force eld. However, remarkably, the combination of free energy estimates obtained with <rs xml:id="12966062" type="software">GAFF</rs> and <rs xml:id="12966063" type="software">CGenFF</rs> force elds (even when considering equivalent sampling time) substantially improves the accuracy. The agreement with experiment in terms of Pearson correlation is slightly better for the FEP+ approach (0.69 AE 0.03) than for the consensus force eld approach based on the non-equilibrium free energy calculations (0.63 AE 0.03). Similar to the AUE comparison, in terms of Pearson correlation, the consensus force eld approach appears to yield higher quality estimates than the individual force elds, when considering all protein-ligand datasets together.</p>
<p>The comparisons described above took into consideration all the simulations performed for each approach, i. 88 However, the simulation time used for obtaining the latter result is not reported, complicating a direct comparison. In the current work, using FEP+ with the OPLSv3 force eld and combining free energy estimates from three independent FEP+ runs resulted in an AUE of 3.66 AE 0.14 kJ mol À1 . The non-equilibrium free energy calculations performed comparably to FEP+ and reached an AUE of 3.70 AE 0.17 kJ mol À1 when using 60 ns per DG estimate, and 3.58 AE 0.18 kJ mol À1 when using 2 Â 60 ns. In terms of correlation, the newer OPLSv3 shows improvement over OPLSv2.1: 0.65 AE 0.04 versus 0.59 AE 0.03. The <rs xml:id="12966064" type="software">pmx</rs>-based calculations show slightly lower correlation of 0.55 AE 0.04. In a recent study, the Wang et al. dataset was investigated with equilibrium TI calculations using the
<rs xml:id="12966065" type="software">Amber</rs><rs xml:id="12966066" type="version" corresp="12966065">18</rs> simulation package. <rs xml:id="12966067" type="bibr">89</rs> The authors reported substantially worse performance than obtained in the current work: AUE of 4.9 kJ mol À1 and correlation of 0.48, investing 74 ns per DG estimate.
</p>
<p>For the dataset of 152 mutations (Fig. 1C) assembled from the literature for this study, both FEP+ and non-equilibrium calculations reach similar correlation: 0.79 AE 0.04 and 0.76 AE 0.04, respectively. Interestingly, for this subset the AUE of the FEP+ predictions is lower than that of the consensus approach by 0.57 AE 0.33 kJ mol À1 (3.2 AE 0.21 and 3.77 AE 0.25 kJ mol À1 for FEP+ and <rs xml:id="12966068" type="software">pmx</rs>, respectively). These observations suggest the accuracy is dependent on the particular protein-ligand system studied. It is also important to note that the number of data points varies among the datasets, ranging from 7 in the case of galectin, to 71 in the case of MCL1. This emphasizes the importance of using large datasets for reliable method comparison.</p>
<p>For all the sets depicted in Fig. 1, the <rs xml:id="12966069" type="software">GAFF</rs> force eld outperforms <rs xml:id="12966070" type="software">CGenFF</rs>. Combining the results of both into a consensus estimate consistently yields a higher, or at least equivalent, accuracy compared to the <rs xml:id="12966071" type="software">GAFF</rs> force eld. Increasing the simulation time invested to obtain a DDG estimate has only a marginal effect on the results, given the time scales considered (at least 60 ns per DG). We have also probed the effect of simulation length on FEP+ accuracy by running 1 ns per l window and using 3 replicas, resulting in 36 ns per DG estimate, as opposed to the standard protocol using 5 ns per l window (180 ns per DG). Also in this case, the accuracy was only marginally affected by the shorter simulations: AUE of 3.88 AE 0.15 (1 ns) and 3.66 AE 0.14 kJ mol À1 (5 ns), and correlation 0.68 AE 0.03 and 0.69 AE 0.03, respectively.</p>
<p>To further assess the sensitivity of the
<rs xml:id="12966072" type="software">GROMACS</rs> calculations to the invested sampling time, we estimated DDG values aer discarding half of the simulation time. Such a protocol resulted in a setup using 3 replicas of 10 ns, which closely matches the 1 ns FEP+ protocol (1 ns Â 12 l-windows Â 3 replicas). The AUE of the <rs xml:id="12966073" type="software">GAFF</rs> calculations was 4.03 AE 0.16 kJ mol À1 and the Pearson correlation 0.59 AE 0.03. The <rs xml:id="12966074" type="software">CGenFF</rs> calculations had an AUE of 4.7 AE 0.19 kJ mol À1 and correlation of 0.53 AE 0.04. The modest decrease in accuracy matches well with the similar effect observed for the FEP+ calculations. It appears that even the shorter investigated sampling times are sufficient to explore the local minima in the vicinity of the starting structure to obtain a converged free energy estimate. This is corroborated by our earlier explorations of sampling strategies applied in drug resistance mutation studies, where investing 54 ns per DG value yielded converged results. 35 The scatter plots of the calculated and experimental double free energy differences provide an intuitive understanding of the ranges spanned by the datasets and the calculated values (Fig. 2). While taken separately the <rs xml:id="12966075" type="software">GAFF</rs> and <rs xml:id="12966076" type="software">CGenFF</rs> force elds produce more outliers than FEP+ with OPLSv3 (Fig. 2 and S1 ‡), the consensus results reduce the number of outliers. The proportion of estimates falling within 1 kcal mol À1 (4.184 kJ mol À1 ) of experiment is 68 AE 2% and 66 AE 2% for the FEP+ and the pmx-based consensus force eld approach respectively. The overall range spanned by the estimated DDG values is comparable between the methods and force elds as well as similar to the distribution of experimental values (Fig. S2 ‡). The consensus non-equilibrium estimates were more accurate than FEP+ for the perturbations associated with a small DDG (Fig. S4 ‡), whereas FEP+ was more accurate for larger DDG perturbations.
</p>
<p>A notable difference between the results of the methods is the magnitude of estimated errors (Fig. 2 and S3 ‡): the nonequilibrium free energy estimates have larger associated errors than those predicted by FEP+. It is important to note that error estimates for the individual DDG values comprise both the uncertainty of the estimator and the standard error of the estimates coming from the different simulation replicas. Furthermore, the consensus approach increases the errors because the <rs xml:id="12966077" type="software">GAFF</rs> and <rs xml:id="12966078" type="software">CGenFF</rs> estimates may differ from each other more than the estimates obtained with individual force elds. While this feature allows for an increased prediction accuracy, it also increases the uncertainty associated with an estimate.</p>
<p>The agreement between the free energy predictions and experiment is system dependent. Fig. 3 summarizes the AUE and Pearson correlation for every protein-ligand complex studied (Fig. S8 ‡ shows average signed errors). Together with the system-dependent accuracy, Fig. 3 again highlights the value of the consensus force eld approach. In several cases the DDG estimate between force elds varies greatly, leading to substantially different
AUEs (<rs xml:id="12966079" type="software">CGenFF</rs> shows larger AUEs for one of the BACE sets, TYK2, MCL1, and P38, while <rs xml:id="12966080" type="software">GAFF</rs> for cMET). This is also the case for the Pearson correlation. Taking the consensus of the estimated free energy differences by using a simple average of the values from the two force elds yields a result outperforming or on par with the best result from a single force eld.
</p>
<p>The improved accuracy due to combination of results from different force elds may seem counterintuitive. In fact, if both force elds yield DDG estimates deviating from experiment in the same direction, the consensus approach would yield only an intermediate quality prediction falling in between the two individual force elds. Such an outcome would still be preferable in a prospective study, since relying on a single force eld might lead the investigation in a wrong direction. In the current work, however, employing a consensus approach generally resulted in an improved prediction accuracy over any of the single force elds. This is only possible because in 33% of all the calculated double free energy differences the values obtained by <rs xml:id="12966081" type="software">GAFF</rs> and <rs xml:id="12966082" type="software">CGenFF</rs> force elds were pointing in opposite directions from the experimental measurement (see also Fig. S10 ‡ for a graphical depiction of the signed deviations from experiment for both force elds plotted one against the other).</p>
<p>The variable performance of calculated DDG for individual protein-ligand complexes can be seen from the scatter plots in Fig. 4 (for the FEP+ estimates see Fig. S6 ‡). In the majority of cases, the estimates fall within 1 kcal mol À1 (4.184 kJ mol À1 ) of the experimental measurement. This indicates that the accuracy is mainly reduced by a small number of outliers. The latter observation holds for both the consensus approach based on the non-equilibrium calculations (Fig. 4) and FEP+ using the OPLSv3 force eld (Fig. S6 ‡). Interestingly, both approaches have difficulties with the MCL1 dataset where only half of the estimates fall within 1 kcal mol À1 (4.184 kJ mol À1 ) of the experimental measurement. 45% of the non-equilibrium estimates fell outside this range for the BACE set of Hunt et al. 64 and for the cMET set. FEP+ had comparable difficulties with the BACE set of Cumming et al. 90 and PDE2. 33 The range spanned by the DDG values also has an inuence on the prediction accuracy (Fig. S5 ‡). An illustrative example for this effect is a set of thrombin inhibitors. The experimental range of the double free energy differences is narrow. The nonequilibrium approach captured the DDG values very accurately in terms of AUE (2.23 AE 0.57 kJ mol À1 ). However, no correlation for the small differences between the ligands was observed. In contrast, FEP+ had a signicantly larger AUE of 4.51 AE 0.82 kJ mol À1 . However, it was able to achieve moderate correlation (0.45 AE 0.18). In general, FEP+ obtained higher correlations: the averaged correlation coefficient was higher for 9 out of 13 datasets (Fig. S7 ‡). In terms of AUE, on average, FEP+ was more accurate than the <rs xml:id="12966083" type="software">pmx</rs>-based calculations for 7 out of 13 datasets. When compared to the previous generation of the OPLS force eld (v2.1), 3 the consensus force eld approach performs better in 6 out of 8 cases in terms of AUE and 3/8 in terms of correlation. It is worth noting that the earlier FEP+ results reported by Wang et al. were more accurate for BACE and thrombin than those obtained here with the newer OPLS version.</p>
<p>Protonation effects. For one system (PTP1B), we looked in detail at the molecular determinants inuencing the free energy calculation accuracy. In particular, we investigated the effects of the protonation state of the catalytic cysteine. PTP1B is a tyrosine phosphatase that harbors a catalytic cysteine (Cys215) that can be oxidized, thus inhibiting the enzyme. 91 When in the apo state, Cys215 has been shown to be deprotonated (pK a ¼ 5.4) and make a covalent bond with the main chain nitrogen of Ser216. 92 The protonation state of Cys215 is not known for the set of PTP1B inhibitors probed here. From the crystallographic structures resolved with four of the ligands in the set, 93 the short Fig. 4 Performance of the <rs xml:id="12966084" type="software">pmx</rs>-based consensus force field calculations for each protein-ligand system studied. The DDG estimates are plotted against their experimentally determined values. Text in the panels: AUE is in kJ mol À1 ; "cor" is Pearson correlation; "1 kcal/mol" denotes the percentage of the estimates that fall within 1 kcal mol À1 (4.184 kJ mol À1 ) of the experimental measurement; "values" refers to the total number of perturbations per dataset.</p>
<p>distance between the cysteine's sulfur and the closest carboxyl group oxygen of a ligand (3.5-3.9 Å) suggests a possible formation of a weak hydrogen bond (Fig. 5).</p>
<p>We further probed whether the ligand's carboxyl group or Cys215 is more likely to be protonated. The empirical pK a predictor <rs xml:id="12966085" type="software">PROPKA</rs> <rs xml:id="12966086" type="version" corresp="12966085">3.1</rs> 94,95 suggested that the pK a for the carboxyl group is less than 5.0 for every ligand in the set. The low carboxyl pK a was also conrmed by the <rs xml:id="12966087" type="publisher" corresp="12966088">ChemAxon</rs>'s <rs xml:id="12966088" type="software" subtype="implicit">predictor</rs>. <rs xml:id="12966089" type="bibr">96</rs> In contrast, the pK a for Cys215 in the complexed system was predicted to be between 9.8 and 10.5, depending on the inhibitor. Taken together, these observations suggest that Cys215 ought to be protonated for the inhibitor set synthesized by Wilson et al. 93 Wang et al., 3 however, modeled a deprotonated variant of Cys215 in their free energy calculations, whilst also keeping the ligand's carboxyl group deprotonated. Although the carboxyl groups of the ligand are not modied in the alchemical simulations it is plausible that structurally diverse inhibitors may be affected differently by the two negative charges nearby. Using the Wang et al. setup with the deprotonated Cys215 we obtained similar quality free energy estimates (Fig. 6). Briey, the Cys(À1) results from Wang et al. had an AUE and correlation of 3.87 AE 0.52 kJ mol À1 and 0.64 AE 0.06, respectively, compared to 3.66 AE 0.56 kJ mol À1 and 0.61 AE 0.08 from the <rs xml:id="12966090" type="software">pmx</rs> consensus predictions, also with similar outliers as seen in the correlation plots. Interestingly, the FEP+ calculations performed here using OPLSv3 showed substantially better accuracy (AUE of 2.8 AE 0.27 kJ mol À1 and correlation of 0.91 AE 0.03), suggesting the newer force eld includes updates that have an improved representation of interactions between the deprotonated thiol and carboxyl group for the investigated set of ligands. Since our empirical prediction suggests that Cys215 could be protonated we have also calculated free energy differences with this protonation state. Interestingly, upon protonation of Cys215 the quality of FEP+ OPLSv3 prediction drops (Fig. 6): AUE 3.68 AE 0.49 kJ mol À1 , correlation 0.8 AE 0.07.</p>
<p>The <rs xml:id="12966091" type="software">pmx</rs> calculations using the consensus force eld approach follow a different trend. When Cys215 is deprotonated and turned into a neutral residue (by redistributing charges on the side-chain atoms), the agreement with experiment increases. This articially constructed cysteine residue should not be interpreted in physical terms (e.g. as a radical). It rather represents a convenient intermediate step between the negative deprotonated cysteine in the active site of PTP1B and the properly protonated neutral Cys215. Agreement with experiment further improves when Cys215 is protonated (Fig. 6): AUE 3.23 AE 0.42 kJ mol À1 , correlation 0.74 AE 0.06. The increased accuracy when protonating Cys215 could be an artifact of a decient parameterization of the thiolate group in <rs xml:id="12966092" type="software">Amber</rs> and <rs xml:id="12966093" type="software">CHARMM</rs> force elds. 97 On the other hand, it may also suggest that the thiol group of the cysteine residue is protonated upon binding of the ligands from the investigated set of PTP1B inhibitors.</p>
<p>It is also important to note that here we only analyzed the effects of protonation changes of the cysteine's thiol group, while the protonation state of the ligands was kept xed. For a complete picture of the free energy landscape underlying the affinity differences for this PTP1B ligand set it might be necessary to include alternative protonation states for the ligands 98,99 and potentially allow the molecules to change their protonation upon binding. Although in the current analysis we veried ligand protonation states by means of empirical predictors, future systematic free energy calculations including ligand protonation effects may improve estimation accuracy.</p>
<p>Sensitivity to ligand parameterization. Disentangling the reasons underlying the quality of free energy calculation performance is not a trivial task. On the one hand inaccuracies frequently arise due to insufficient sampling. While this can be circumvented by increasing simulation time or adding more replicas, the problem of imperfect force eld parameterization represents another major source of errors. The calculated free energies integrate contributions from the protein force eld, ligand parameterization and water model, all of which are prone to introducing errors that may lead to unexpected outcomes. The galectin data set serves as an example for such effects.</p>
<p>The set of galectin inhibitors contains only 8 ligands connected by 7 perturbations. OPLSv3 performed particularly well in this case: AUE of 1.2 AE 0.5 kJ mol À1 , correlation of 0.98 (Fig. 3). Both <rs xml:id="12966094" type="software">GAFF</rs> and <rs xml:id="12966095" type="software">CGenFF</rs> force elds show a lower accuracy in terms of AUE (3.0 AE 1.2 and 2.2 AE 0.4 kJ mol À1 , respectively). In terms of correlation, <rs xml:id="12966096" type="software">GAFF</rs> has a below-average agreement with experiment and a large associated uncertainty (0.41 AE 0.4). A closer look into the DDG estimates obtained with the <rs xml:id="12966097" type="software">GAFF</rs> force eld highlights a peculiar case of possible error cancellation in the free energy estimates (Fig. 7). A large AUE for the perturbation transforming a methylamino group (-NHMe) to methoxy (-OMe) suggests that the parameterization of one or both of these moieties might be imperfect. However, perturbations of these groups into more chemically similar substituents gave more accurate DDG estimates: methylamine to dimethylamine; methoxy to hydroxyl. The parameterization errors pertaining to a specic chemical group cancel out until transformations involving different chemistry (with different parameterization errors) are introduced: e.g. free energy differences within the group of ligands containing methylamine in the current case are represented correctly. Similarly, the free energy differences within the group of compounds containing methoxy and hydroxyl groups are accurately estimated. However, the free energy difference between these two sets of ligands containing different chemical groups is not captured accurately (at least not with the sampling time used in the current study).</p>
<p>Directions for force eld optimization. The consensus force eld approach provided more accurate predictions than the individual <rs xml:id="12966098" type="software">GAFF</rs> and <rs xml:id="12966099" type="software">CGenFF</rs> force elds. As already mentioned, an improvement in accuracy is only possible if the two force eld estimates are opposite with respect to the experimental result. The cMet protein-ligand dataset provides an informative example: in 14 out of 25 (56%) cases <rs xml:id="12966100" type="software">GAFF</rs> and <rs xml:id="12966101" type="software">CGenFF</rs> predictions had an error in different directions from the experimental measurement. The cMet inhibitor set contains 12 ligands with a common scaffold (Fig. 8A) and a single substitution site (Fig. 8B), except for compound 1_21, which also has a cyano group in place of a scaffold uorine atom.</p>
<p>Overall, for this system FEP+ showed an AUE of 3.2 AE 0.58 kJ mol À1 , while <rs xml:id="12966102" type="software">CGenFF</rs> was only slightly worse with an AUE of 3.78 AE 0.59 kJ mol À1 . Interestingly, this dataset gave the worst performance for <rs xml:id="12966103" type="software">GAFF</rs> among all the investigated protein-ligand complexes: AUE of 5.55 AE 0.94 kJ mol À1 .</p>
<p>A closer look at the major discrepancies between force elds reveals some peculiar trends that could be useful for further force eld ne tuning. For example, in all four transformations with compound 4200_15, <rs xml:id="12966104" type="software">GAFF</rs> overestimates the binding affinity of this ligand in comparison to both <rs xml:id="12966105" type="software">CGenFF</rs> and experiment. Similarly, compound 400_10 is consistently (3 transformations) predicted by <rs xml:id="12966106" type="software">GAFF</rs> to be a higher affinity binder than determined experimentally. In contrast, all 6 transformations involving ligand 5300_8 with <rs xml:id="12966107" type="software">GAFF</rs> suggest the inhibitor to be a far worse binder than measured experimentally. Although pinpointing the exact force eld parameters that are responsible for these inaccuracies is not trivial, the trends observed for certain chemical groups suggest likely candidates for re-parameterization. Similarly, we can envisage future work using large-scale scans of such calculated thermodynamic properties of biomolecular complexes to aid force eld development.</p>
<p>Overall, the current investigation revealed several consistent trends. The accuracy in terms of AUE was comparable for the FEP+ and <rs xml:id="12966108" type="software">pmx</rs>-based calculations, while the correlation was slightly higher for FEP+ when using the OPLSv3 force eld (Fig. 1). The <rs xml:id="12966109" type="software">GAFF</rs> force eld yielded higher accuracy than <rs xml:id="12966110" type="software">CGenFF</rs>, however, the consensus approach of averaging the results from both force elds performed better or equally well as the best performing force eld. This indicates that the errors made by the force elds in free energy estimates are in some cases cancelling out, allowing for an increased accuracy. This effect has been previously observed in the free energy estimations for amino acid mutations in protein stability and proteinligand binding studies, 27,35 as well as for nucleotide mutations in protein-DNA interactions. 29 Furthermore, the benets of the consensus approach are emphasized in the case-by-case analysis of the protein-ligand complexes studied (Fig. 3). Here, it becomes evident that in a prospective study of a particular system relying on the results of a single force eld may lead to a substantial decrease in the predictive accuracy. In fact, in the current investigation, the two force elds gave opposite results with respect to experiment for as many as 33% of the cases, while in 10% of the cases the estimates from two force elds showed a statistically signicant systematic difference. Admittedly, using a consensus approach requires additional effort in preparing the simulation system. With the currently available soware packages, 68,71 however, automation of such procedures should not pose a considerable challenge.</p>
<p>The signicant difference in standard errors obtained from repeated calculations represents an interesting difference between the FEP+ and non-equilibrium TI based free energy results. With an average standard error of 0.57 kJ mol À1 per DDG value, FEP+ provides predictions with high precision. That is, the DDG estimates from FEP+ converge to highly similar values, with little spread in the results. This might be a consequence of the enhanced sampling technique (REST 65 ) ensuring convergence of the FEP+ simulations. <rs xml:id="12966111" type="software">pmx</rs>-based non-equilibrium calculations, on the other hand, come with higher uncertainty: 2.36 kJ mol À1 on average for the consensus results. The larger spread of the calculated DDG values, in comparison to FEP+, suggests that the non-equilibrium calculations could still benet from an increased convergence: longer simulations or an enhanced sampling approach present a compelling direction for further investigation. Considering that both FEP+ and <rs xml:id="12966112" type="software">pmx</rs>-based calculations have, on average, a similar AUE of $3.7 kJ mol À1 , the high precision associated with FEP+ indicates that the method is highly precise even for those predictions that are substantially different from experiment. The <rs xml:id="12966113" type="software">pmx</rs>-based calculations give a larger prediction uncertainty, thus encompassing the experimental observation within the condence interval of the estimate. It remains to be explored whether increased precision of the <rs xml:id="12966114" type="software">pmx</rs>-based calculations (using longer simulations or an enhanced sampling technique) will have an effect on the accuracy of free energy estimates.</p>
<p>The success of combining results from <rs xml:id="12966115" type="software">GAFF</rs> and <rs xml:id="12966116" type="software">CGenFF</rs> indicates differences in the force eld parameterization. Naturally, the simplistic forms of the potential energy functions used by the classical molecular mechanics force elds cannot capture the full complexity of molecular interactions, for which a more complex representation would be required, e.g., polarizability. 100,101 Force eld parameterization based on a large number of quantum chemical calculations is helpful, as illustrated by the high accuracy achieved by FEP+ with the OPLSv3 force eld. However, the simplied description of the potential energy leads to unavoidable, inherent limitations. Thus, at this time, combining estimates from different force elds may be an attractive avenue to pursue. Given that parameterization of different force elds relies on different theoretical premises, combining their results may indirectly capture features of molecular interactions that are inaccessible to a single force eld. Finally, the signicant prediction differences obtained when altering the protonation state of a single amino acid sidechain highlight the sensitivity of alchemical methods to the simulation setup and force eld parameterization details. Furthermore, this example emphasizes the need for transparent and open-source force eld parameters akin to those put forward by the Open Force Field Consortium. 102</p>
<p>In the current investigation, we have demonstrated that a nonequilibrium free energy calculation method based on freely available open-source soware performs on par with state-of-art commercial soware. The results obtained from a large-scale protein-ligand relative binding affinity scan highlight an improvement in accuracy when combining results from multiple force elds into a consensus estimate. The presented approach is readily applicable in drug discovery lead optimization projects. Descriptive workows, comprising the technical steps required for the free energy calculations, will further provide an easy-to-use approach for ligand-protein binding affinity prediction.</p>
<p>This journal is © The Royal Society of Chemistry 2020</p>
<p>This journal is © The Royal Society of Chemistry 2020 Chem. Sci., 2020, 11, 1140-1152 | 1143</p>
<p>This journal is © The Royal Society of Chemistry 2020 Chem. Sci., 2020, 11, 1140-1152 | 1149</p>
<p>This journal is © The Royal Society of Chemistry 2020 Chem. Sci., 2020, 11, 1140-1152 | 1151</p>
<p>We thank Dr James P. Edwards for reviewing the manuscript and the <rs xml:id="12966117" type="software">GROMACS</rs> development team for making their soware freely available. L. P. B. was partly funded by the European Union's Horizon 2020 Research and Innovation Programme under grant agreement No 675451 (CompBioMed project). The project was also partly funded by Vlaams Agentschap Innoveren &amp; Ondernemen Project 155028. V. G. and B. L. d. G. were supported by the BioExcel CoE (http://www.bioexcel.eu), a project funded by the European Union (Contract H2020-EINFRA-2015-1-675728). M. A. was supported by a Postdoctoral Research Fellowship of the Alexander von Humboldt Foundation.</p>
<p>The manuscript was written through contributions of all authors. All authors have given approval to the nal version of the manuscript.</p>
<p>There are no conicts to declare.</p>
</text>
</tei>